/* jquery.minimuslider v.1.1 | (c) 2014 Federica Sibella musings(at)musings(dot)it | http://www.musings.it | MIT license */
;(function(d){function w(a){var b=d("#minimus-slide"+a.instance+"_"+a.current),c=b.find("img");if(0<c.length){c.attr("src")!=c.attr("data-src")&&c.attr("src",c.attr("data-src"));var k=new Image;k.onload=function(){var d=k.height/k.width,e=a.slider,f=a.calc_width,g=a.calc_height,n=Math.round(f*d);"adjust"==a.options.ratio?(b.css({height:n}),c.css({width:f,height:n}),e.css({height:n})):n>g?(g=Math.round((n-g)/2),c.css({width:f,height:n,top:-g})):(n=Math.round(g/d),f=Math.round((n-f)/2),c.css({width:n,
height:g,left:-f}))};k.src=c.attr("src");0==b.find(".minimus-caption").length&&void 0!=c.attr("title")&&""!=c.attr("title")&&b.append("<div class='minimus-caption'><p>"+c.attr("title")+"</p></div>").promise().done(function(){var a=b.find(".minimus-caption").outerHeight(!0);b.find(".minimus-caption").css({bottom:-a}).delay(800).animate({bottom:0},300)})}}function x(a){a=d("#minimus-slide"+a.instance+"_"+a.current);if(0<a.find(".minimus-caption").length){var b=a.find(".minimus-caption").outerHeight(!0);
a.find(".minimus-caption").css({bottom:-b}).delay(800).animate({bottom:0},300)}}function y(a,b,c){var k=d("#minimus-slide"+a.instance+"_"+a.current),l=d("#minimus-slide"+a.instance+"_"+b);b=a.options;var e=a.calc_width,f=a.calc_height,g=0,n=0,h=a.next;a.prev.off();h.off();d(document).on("touchend").off();"n"==c?(g=e+a.margin,n=f+a.margin):"p"==c&&(g=-(e+a.margin),n=-(f+a.margin));switch(b.animation_type){case "horizontal":k.css({left:g}).show();l.animate({left:-g},b.animation_duration,function(){l.hide().toggleClass("active")});
k.animate({left:0},b.animation_duration,function(){s(a)});break;case "vertical":k.css({top:n}).show();l.animate({top:-n},b.animation_duration,function(){l.hide().toggleClass("active")});k.animate({top:0},b.animation_duration,function(){s(a)});break;case "fade":l.fadeOut(b.animation_duration).toggleClass("active"),k.fadeIn(b.animation_duration,function(){s(a)})}}function s(a){var b=d("#minimus-slide"+a.instance+"_"+a.current),c=a.prev,k=a.next,l=a.slider,e=a.mm;b.toggleClass("active");k.on("click touchstart touchend",
function(a){a.preventDefault();d(this).minimus("next")});c.on("click touchstart touchend",function(a){a.preventDefault();d(this).minimus("prev")});d(document).on("touchstart",l,function(a){a=void 0==a.originalEvent.touches?a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];e.ox=a.pageX;e.oy=a.pageY;e.startTime=(new Date).getTime()});d(document).on("touchmove",l,function(a){a.preventDefault()});d(document).on("touchend",l,function(a){a=void 0==a.originalEvent.touches?a:a.originalEvent.touches[0]||
a.originalEvent.changedTouches[0];d(this).offset();e.dx=a.pageX-e.ox;e.dy=a.pageY-e.oy;e.endTime=(new Date).getTime()-e.startTime;(e.dx<-e.swipeTreshold||e.dy<-e.swipeTreshold)&&e.endTime<e.allowedTime?l.minimus("next"):(e.dx>e.swipeTreshold||e.dy>e.swipeTreshold)&&e.endTime<e.allowedTime&&l.minimus("prev")})}function z(a,b){var c=d("#minimus-slide"+a+"_"+b);c.children().is("audio,video")&&(c=c.children("audio,video"),!1===c[0].paused&&c[0].pause())}function q(a){if("string"===typeof a){var b=a.indexOf("_");
-1!=b&&(a=a.substr(b+1))}return a}function A(a,b){var c=a;"string"===typeof a&&-1!=a.indexOf("%")&&(c=parseInt(a.slice(0,-1))/100,c=parseInt(b*c));return c}function B(a){var b=a.slider,c=a.slide,k=a.options.min_width,l=a.options.min_height,e=a.slider_ratio,f=a.calc_width,g=a.calc_height,f=Math.min(b.parent().width(),d(window).width()-40),n=d("#minimus-slide"+a.instance+"_"+a.current),h=n.find("img");if(0<h.length){var p=new Image;p.onload=function(){var b=p.height/p.width,c=a.slider,d=a.calc_width,
e=a.calc_height,r=Math.round(d*b);"adjust"==a.options.ratio?(n.css({height:r}),h.css({width:d,height:r}),c.css({height:r})):r>e?(e=Math.round((r-e)/2),h.css({width:d,height:r,top:-e})):(r=Math.round(e/b),d=Math.round((r-d)/2),h.css({width:r,height:e,left:-d}))};p.src=h.attr("src")}g=Math.round(f*e);f<k&&(f=k,g=Math.round(f*e),g<l&&(g=l));g<l&&(g=l,f=Math.round(g/e),f<k&&(f=k));c.css({width:f,height:g});c.children("video,iframe").css({width:f,height:g});b.css({width:f,height:g});a.calc_width=f;a.calc_height=
g;a.slide=c;a.slider=b;return a}var h=[],p=0,v={init:function(a){this.each(function(){var b=d(this),c=b.data("minimus"),k=d(),c=d(),l=d(),e=d(),f=d(),g=d(),n=d(),q=0,s=.565,t=0,u=0,m={swipeTreshold:100,allowedTime:300},k=d.extend({width:"100%",height:"100%",ratio:.5625,animation_type:"horizontal",animation_duration:600,animation_start:"manual",animation_interval:4E3},a);b.attr("data-id","minimus-slider_"+p);c=b.find(".minimus-slide");q=c.length-1;c.each(function(a){d(this).attr("id","minimus-slide"+
p+"_"+a)});l=b.next(".minimus-navslide");e=l.find(".minimus-start").attr("data-id","minimus-start_"+p);f=l.find(".minimus-stop").attr("data-id","minimus-stop_"+p);g=l.find(".minimus-next").attr("data-id","minimus-next_"+p);n=l.find(".minimus-prev").attr("data-id","minimus-prev_"+p);t=A(k.width,b.parent().width());"number"==typeof k.ratio&&(s=k.ratio);u=Math.round(t*s);c.css({"box-sizing":"content-box",width:t,height:u,top:0,left:0});if(void 0!=typeof c.children("img").attr("data-src")&&c.children("img").attr("src")!=
c.children("img").attr("data-src")){var v=c.children("img").attr("src");c.children("img").css({background:"url("+v+") no-repeat center center"})}c.children("img,video,iframe").css({"box-sizing":"content-box",width:t,height:u});c.not(":first").hide();c.filter(":first").addClass("active");b.css({"box-sizing":"content-box",width:t,height:u});g.on("click touchstart touchend",function(a){a.preventDefault();d(this).minimus("next")});n.on("click touchstart touchend",function(a){a.preventDefault();d(this).minimus("prev")});
f.on("click",function(a){a.preventDefault();b.minimus("stop");d(this).hide();e.show()});e.on("click",function(a){a.preventDefault();b.minimus("start");d(this).hide();f.show()});d(document).on("touchstart",b,function(a){a=void 0==a.originalEvent.touches?a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];m.ox=a.pageX;m.oy=a.pageY;m.startTime=(new Date).getTime()});d(document).on("touchmove",b,function(a){a.preventDefault()});d(document).on("touchend",b,function(a){a=void 0==a.originalEvent.touches?
a:a.originalEvent.touches[0]||a.originalEvent.changedTouches[0];d(this).offset();m.dx=a.pageX-m.ox;m.dy=a.pageY-m.oy;m.endTime=(new Date).getTime()-m.startTime;(m.dx<-m.swipeTreshold||m.dy<-m.swipeTreshold)&&m.endTime<m.allowedTime?b.minimus("next"):(m.dx>m.swipeTreshold||m.dy>m.swipeTreshold)&&m.endTime<m.allowedTime&&b.minimus("prev")});b.data("minimus",{slider:b,slide:c,totslides:q,margin:100,navslide:l,start:e,stop:f,prev:n,next:g,current:0,timer:0,options:k,instance:p,slider_ratio:s,calc_width:t,
calc_height:u,mm:m});c=b.data("minimus");h[p]=c;w(b.data("minimus"));d.fn.minimus("resize",p);"auto"==k.animation_start?(f.show(),e.hide(),b.minimus("start")):"manual"==k.animation_start&&(b.minimus("stop"),f.hide(),e.hide());p++;return h})},next:function(){var a=q(d(this).attr("data-id")),b=h[a],c=b.current;b.current++;b.current>b.totslides&&(b.current=0);z(a,c);w(b);y(b,c,"n");x(b);h[a]=b;return h},prev:function(){var a=q(d(this).attr("data-id")),b=h[a],c=b.current;b.current--;0>b.current&&(b.current=
b.totslides);z(a,c);w(b);y(b,c,"p");x(b);h[a]=b;return h},resize:function(a){"number"!=typeof a&&(a=q(d(this).attr("data-id")));var b=h[a],b=B(b);h[a]=b;return h},start:function(){var a=q(d(this).attr("data-id")),b=h[a],c=b.slider;0!=b.timer&&clearInterval(b.timer);b.timer=setInterval(function(){c.minimus("next")},b.options.animation_interval);h[a]=b;return h},stop:function(){var a=q(d(this).attr("data-id")),b=h[a];clearInterval(b.timer);h[a]=b;return h},destroy:function(){var a=q(d(this).attr("data-id")),
a=h[a];a.prev.off();a.next.off();d.fn.minimus("stop");a.slide.find("minimus-caption").remove();d.removeData(a,"minimus");this.unbind();this.element=null}};d(window).resize(function(){for(i=0;i<p;i++)d.fn.minimus("resize",i)});d.fn.minimus=function(a){if(v[a])return v[a].apply(this,Array.prototype.slice.call(arguments,1));if("object"!==typeof a&&a)d.error("Method "+a+" does not exist on jQuery.minimus");else return v.init.apply(this,arguments)}})(jQuery);